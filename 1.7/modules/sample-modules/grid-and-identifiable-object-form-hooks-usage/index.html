<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.82.0" />
    <meta name="description" content="Learn how to extend, modify and test PrestaShop, create modules, themes, and more.">
<meta name="twitter:image" content="https://devdocs.prestashop.com/images/social-cover.jpg" />
<meta name="twitter:site" content="@prestashop" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Grid and identifiable object form hooks usage example" />
<meta name="twitter:description" content="Learn how to extend, modify and test PrestaShop, create modules, themes, and more.">
<meta property="og:image" content="https://devdocs.prestashop.com/images/social-cover.jpg" />
<meta property="og:site_name" content="PrestaShop" />
<meta property="og:title" content="Grid and identifiable object form hooks usage example" />
<meta property="og:description" content="Learn how to extend, modify and test PrestaShop, create modules, themes, and more.">
<meta name="author" content="PrestaShop">

    <link rel="icon" href="/images/preston-logo@2x.png" type="image/png">

    <title>Grid and identifiable object form hooks usage example :: PrestaShop Developer Documentation</title>

    
    <link href="/css/font-awesome.min.css?1627507034" rel="stylesheet">
    <link href="/css/syntax-github.css?1627507034" rel="stylesheet">
    <link href="/css/featherlight.min.css?1627507034" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1627507034" rel="stylesheet">
    <link href="/css/auto-complete.css?1627507034" rel="stylesheet">
    
    <link href="/style.css?1627507034" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1627507034"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

  </head>
  <body class="" data-url="/1.7/modules/sample-modules/grid-and-identifiable-object-form-hooks-usage/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">PrestaShop DevDocs</a>

    </div>
    
        <div class="searchbox-extended">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input id="search-by" type="search" placeholder="Search...">
</div>


    
  </div>

    <div class="highlightable">
    <ul class="topics">

      
        
      
    </ul>

    
    

    
    <section id="footer">
      <p><a href="https://github.com/PrestaShop/PrestaShop/"><i class="fa fa-github" aria-hidden="true"></i> PrestaShop on GitHub</a></p>
<p><a href="https://github.com/PrestaShop/PrestaShop/issues"><i class="fa fa-bug" aria-hidden="true"></i> Report a bug</a></p>
<p><a href="https://www.prestashop-project.org/slack/readme/"><i class="fa fa-comment" aria-hidden="true"></i> Join us on Slack</a></p>

    </section>
  </div>
</nav>





      <section id="body">
      <div id="overlay"></div>
      <div class="padding highlightable">
        
<div>
  <div id="top-bar">
    
      
      
      
      <div id="top-github-link">
        <a class="github-link" title='Improve this page' href="https://github.com/PrestaShop/docs/edit/master/src/content/1.7/modules/sample-modules/grid-and-identifiable-object-form-hooks-usage.md" target="blank">
          <i class="fa fa-pencil"></i>
          <span id="top-github-link-text">Improve this page</span>
        </a>
        <a class="how-to-improve" href="/1.7/contribute/documentation/how/">
          <i class="fa fa-question-circle"></i>
          <span>How</span>
        </a>
      </div>
      
    
    <div id="breadcrumbs" itemscope="" itemtype="http://schema.org/breadcrumb">
      <span id="sidebar-toggle-span">
        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
          <i class="fa fa-bars"></i>
        </a>
      </span>
      <span class="links">
        
            
            
              
              
            
            
              
              
            
            
              
              
            
            
              
              
            
            
              <a href='/'>Home</a> > <a href='/1.7/'>PrestaShop 1.7</a> > <a href='/1.7/modules/'>Modules</a> > <a href='/1.7/modules/sample-modules/'>Sample modules</a> > Grid and identifiable object form hooks usage example
            
          
            
          
            
          
            
          
            
          
      </span>
    </div>
  </div>
</div>




        

        
        
          
            <div id="toc">
  <div class="wrapper">
    <div id="toc-title">Table of Contents</div>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#grid-and-identifiable-object-form-hooks-usage-example">Grid and identifiable object form hooks usage example</a>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#register-hooks">Register hooks</a></li>
        <li><a href="#adding-new-column-to-customers-grid">Adding new column to customers grid</a>
          <ul>
            <li><a href="#extending-grid-definition-and-filters">Extending grid definition and filters</a></li>
            <li><a href="#creating-route-for-toggle-column">Creating route for toggle column</a></li>
            <li><a href="#extending-grid-query-builder">Extending grid query builder</a></li>
            <li><a href="#result">Result</a></li>
          </ul>
        </li>
        <li><a href="#adding-new-form-field-to-customer-form">Adding new form field to customer form</a>
          <ul>
            <li><a href="#modifying-customers-form-builder">Modifying customers form builder</a></li>
            <li><a href="#result-1">Result</a></li>
          </ul>
        </li>
        <li><a href="#extending-customers-form-after-create-and-update-actions">Extending customers form after create and update actions</a></li>
      </ul>
    </li>
  </ul>
</nav>

    <div id="navigation">
  
  

  

  
    
    
      
        
        
      
      
      
      
        
      
      

      
        
    
    
      
        
        
      
      
      
      
        
      
      

      
        
    
    
      
        
          
          
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
        
      
      
      
      
        
      
      

      
        
    
    
      
        
          
          
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
        
      
      
      
      
        
      
      

      
        
    
    
      
        
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
          
          
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
        
      
      

      
        
    
    
      
        
      
      
      
      
      

      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
        
    
    
      
        
      
      
      
      
      

      
    
  
      
    
  
      
    
  
      
    
  

  
  
  <a class="nav nav-next" href="/1.7/modules/sample-modules/order-pages-new-hooks/" title="Order view page new hooks demo tutorial" style="margin-right: 0px;">
    <i class="fa fa-chevron-right"></i>
    Next article
  </a>
  
</div>

  </div>
</div>

          
        

        <div id="body-inner">

          




<h1 id="grid-and-identifiable-object-form-hooks-usage-example">Grid and identifiable object form hooks usage example</h1>

<div class="magic-version-pill" data-version="1.7.6" data-title="New in PrestaShop 1.7.6"></div>


<h2 id="introduction">Introduction</h2>
<p>In this tutorial we are going to build module which extends customers list with one extra column
which can be toggled. It can have two states - turned on or off. In customer creation and edit
form we will add switch which will also manage the same state. By following this tutorial you will learn
how to:</p>
<ul>
<li>extend modern grids. <a href="/1.7/development/components/grid/">Grid component</a></li>
<li>extend identifiable object form. <a href="/1.7/development/architecture/migration-guide/forms/crud-forms/">identifiable object form</a></li>
</ul>
<p>The module created within this tutorial can be found <a href="https://github.com/PrestaShop/demo-cqrs-hooks-usage-module">here</a></p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>To be familiar with basic module creation.</li>
</ul>
<h2 id="register-hooks">Register hooks</h2>
<p>On module installation the following hooks are being registered:</p>
<ul>
<li><code>action</code><strong>Customer</strong><code>GridDefinitionModifier</code> - for adding new column to customers grid.</li>
<li><code>action</code><strong>Customer</strong><code>GridQueryBuilderModifier</code> - for modifying customers grid sql.</li>
<li><code>action</code><strong>Customer</strong><code>FormBuilderModifier</code> - for adding new field to customers create or edit form field.</li>
<li><code>actionAfterCreate</code><strong>Customer</strong><code>FormHandler</code> - to execute the saving process of added field from the module.</li>
<li><code>actionAfterUpdate</code><strong>Customer</strong><code>FormHandler</code> - to execute the update process of added field from the module.</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">install</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">install</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">registerHook</span><span class="p">(</span><span class="s1">&#39;actionCustomerGridDefinitionModifier&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">registerHook</span><span class="p">(</span><span class="s1">&#39;actionCustomerGridQueryBuilderModifier&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">registerHook</span><span class="p">(</span><span class="s1">&#39;actionCustomerFormBuilderModifier&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">registerHook</span><span class="p">(</span><span class="s1">&#39;actionAfterCreateCustomerFormHandler&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">registerHook</span><span class="p">(</span><span class="s1">&#39;actionAfterUpdateCustomerFormHandler&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">installTables</span><span class="p">()</span>
    <span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="notices note" >Hooks <code>action</code><strong>Customer</strong><code>GridDefinitionModifier</code> and <code>action</code><strong>Customer</strong><code>GridQueryBuilderModifier</code> are built
using grid id which in this case is <strong>Customer</strong>. If you want to use hook for any other grid
You can check any definition factory service in <code>PrestaShop\PrestaShop\Core\Grid\Definition\Factory</code> to see available grid ids. Grid id is returned by <code>getId()</code> method.
<br />
<br />
Hooks <code>action</code><strong>Customer</strong><code>FormBuilderModifier</code>,<code>actionAfterCreate</code><strong>Customer</strong><code>FormHandler</code> and <code>actionAfterUpdate</code><strong>Customer</strong><code>FormHandler</code> are built using unique identifier which
in this case is <strong>Customer</strong> is retrieved from its form type <strong>CustomerType</strong>. E.g id retrieved from <strong>ManufacturerType</strong> will be <strong>Manufacturer</strong>. Some types might use
function <code>getBlockPrefix</code> to retrieve the unique id</div>

<h2 id="adding-new-column-to-customers-grid">Adding new column to customers grid</h2>
<h3 id="extending-grid-definition-and-filters">Extending grid definition and filters</h3>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">PrestaShop\PrestaShop\Core\Grid\Definition\GridDefinitionInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">PrestaShop\PrestaShop\Core\Grid\Column\Type\Common\ToggleColumn</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">PrestaShopBundle\Form\Admin\Type\YesAndNoChoiceType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Ps_DemoCQRSHooksUsage</span> <span class="k">extends</span> <span class="nx">Module</span>
<span class="p">{</span>
    <span class="c1">// ...
</span><span class="c1"></span>    
    <span class="sd">/**
</span><span class="sd">     * Hook allows to modify Customers grid definition.
</span><span class="sd">     * This hook is a right place to add/remove columns or actions (bulk, grid).
</span><span class="sd">     *
</span><span class="sd">     * @param array $params
</span><span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">hookActionCustomerGridDefinitionModifier</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="sd">/** @var GridDefinitionInterface $definition */</span>
        <span class="nv">$definition</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;definition&#39;</span><span class="p">];</span>

        <span class="nv">$translator</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getTranslator</span><span class="p">();</span>

        <span class="nv">$definition</span>
            <span class="o">-&gt;</span><span class="na">getColumns</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">addAfter</span><span class="p">(</span>
                <span class="s1">&#39;optin&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="k">new</span> <span class="nx">ToggleColumn</span><span class="p">(</span><span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">))</span>
                    <span class="o">-&gt;</span><span class="na">setName</span><span class="p">(</span><span class="nv">$translator</span><span class="o">-&gt;</span><span class="na">trans</span><span class="p">(</span><span class="s1">&#39;Allowed for review&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="s1">&#39;Modules.Ps_DemoCQRSHooksUsage&#39;</span><span class="p">))</span>
                    <span class="o">-&gt;</span><span class="na">setOptions</span><span class="p">([</span>
                        <span class="s1">&#39;field&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;primary_field&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;id_customer&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;route&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ps_democqrshooksusage_toggle_is_allowed_for_review&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;route_param_name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;customerId&#39;</span><span class="p">,</span>
                    <span class="p">])</span>
            <span class="p">)</span>
        <span class="p">;</span>

        <span class="nv">$definition</span><span class="o">-&gt;</span><span class="na">getFilters</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span>
            <span class="p">(</span><span class="k">new</span> <span class="nx">Filter</span><span class="p">(</span><span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">,</span> <span class="nx">YesAndNoChoiceType</span><span class="o">::</span><span class="na">class</span><span class="p">))</span>
            <span class="o">-&gt;</span><span class="na">setAssociatedColumn</span><span class="p">(</span><span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>This hook, through <code>$params</code> array, received <code>GridDefinition</code> that defines how the grid is rendered. See <a href="/1.7/development/components/grid/#grid-definition">Grid definition</a> for more information.<br>
In this sample a new toggable column which determines if the customer is eligible to review products is added just after another column which has id <code>optin</code>. The sample code also demonstrates how add new filter.</p>
<h3 id="creating-route-for-toggle-column">Creating route for toggle column</h3>
<p><code>ToggleColumn</code> - used to display booleans, it will display an icon instead of the value. If user clicks on it, this triggers a toggle of the boolean value. More information about this column and all available parameters can be found <a href="/1.7/development/components/grid/columns-reference/toggle/">here</a>.<br>
As in this sample module we are creating <code>ToggleColumn</code> we need to configure the route in which the toggling action will be performed. Indeed when the end-user clicks on this column, an ajax request is performed and must reach one new controller to handle the action (here: toggle a value on and off).<br>
If you only want to display data then this step can be skipped. E.g you are creating <code>DataColumn</code>. See <a href="/1.7/development/components/grid/columns-reference/">Column references</a> for full list of grid columns available.</p>
<ul>
<li>Create controller <code>DemoCQRSHooksUsage\Controller\Admin\CustomerReviewController</code>:</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">namespace</span> <span class="nx">DemoCQRSHooksUsage\Controller\Admin</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">PrestaShopBundle\Controller\Admin\FrameworkBundleAdminController</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CustomerReviewController</span> <span class="k">extends</span> <span class="nx">FrameworkBundleAdminController</span>
<span class="p">{</span>
<span class="p">}</span>
</code></pre></div><ul>
<li>Create controller <code>action</code>:</li>
</ul>

<div class="notices note" ><p><strong>This example has been simplified for practical reasons.</strong></p>
<p>You can find full implementation <a href="https://github.com/PrestaShop/demo-cqrs-hooks-usage-module">here</a> which uses CQRS pattern to toggle the reviewer state. <a href="/1.7/development/architecture/domain/cqrs/">More about it here</a>.</p>
</div>

<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">namespace</span> <span class="nx">DemoCQRSHooksUsage\Controller\Admin</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">PrestaShopBundle\Controller\Admin\FrameworkBundleAdminController</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CustomerReviewController</span> <span class="k">extends</span> <span class="nx">FrameworkBundleAdminController</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">toggleIsAllowedForReviewAction</span><span class="p">(</span><span class="nv">$customerId</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//  updating reviewer state can be handled here
</span><span class="c1"></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirectToRoute</span><span class="p">(</span><span class="s1">&#39;admin_customers_index&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><ul>
<li>As this is a Symfony controller, we must configure the related routing (read more about <a href="https://symfony.com/doc/current/routing.html">symfony routing</a>), which means create a route in <code>ps_democqrshooksusage/config/routes.yml</code> file:</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-yml" data-lang="yml"><span class="w">
</span><span class="w"></span><span class="nt">ps_democqrshooksusage_toggle_is_allowed_for_review</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">demo-cqrs-hook-usage/{customerId}/toggle-is-allowed-for-review</span><span class="w">
</span><span class="w">  </span><span class="nt">methods</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">POST]</span><span class="w">
</span><span class="w">  </span><span class="nt">defaults</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">_controller</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;DemoCQRSHooksUsage\Controller\Admin\CustomerReviewController::toggleIsAllowedForReviewAction&#39;</span><span class="w">
</span><span class="w">  </span><span class="nt">requirements</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">customerId</span><span class="p">:</span><span class="w"> </span><span class="l">\d+</span><span class="w">
</span></code></pre></div><p>Route name <code>ps_democqrshooksusage_toggle_is_allowed_for_review</code> matches the one that was passed as mandatory option when creating the
<code>ToggleColumn</code>.</p>
<h3 id="extending-grid-query-builder">Extending grid query builder</h3>
<p>By just extending grid definition we won&rsquo;t be able to display any data since we need to fetch it first. Luckily, we can add additional sql
conditions by extending <a href="https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/query-builder.html">doctrine&rsquo;s query builder</a>.</p>
<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">use</span> <span class="nx">Doctrine\DBAL\Query\QueryBuilder</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">PrestaShop\PrestaShop\Core\Search\Filters\CustomerFilters</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Ps_DemoCQRSHooksUsage</span> <span class="k">extends</span> <span class="nx">Module</span>
<span class="p">{</span>

    <span class="c1">// ...
</span><span class="c1"></span>
    <span class="sd">/**
</span><span class="sd">     * Hook allows to modify Customers query builder and add custom sql statements.
</span><span class="sd">     *
</span><span class="sd">     * @param array $params
</span><span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">hookActionCustomerGridQueryBuilderModifier</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="sd">/** @var QueryBuilder $searchQueryBuilder */</span>
        <span class="nv">$searchQueryBuilder</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;search_query_builder&#39;</span><span class="p">];</span>

        <span class="sd">/** @var CustomerFilters $searchCriteria */</span>
        <span class="nv">$searchCriteria</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;search_criteria&#39;</span><span class="p">];</span>

        <span class="nv">$searchQueryBuilder</span><span class="o">-&gt;</span><span class="na">addSelect</span><span class="p">(</span>
            <span class="s1">&#39;IF(dcur.`is_allowed_for_review` IS NULL,0,dcur.`is_allowed_for_review`) AS `is_allowed_for_review`&#39;</span>
        <span class="p">);</span>

        <span class="nv">$searchQueryBuilder</span><span class="o">-&gt;</span><span class="na">leftJoin</span><span class="p">(</span>
            <span class="s1">&#39;c&#39;</span><span class="p">,</span>
            <span class="s1">&#39;`&#39;</span> <span class="o">.</span> <span class="nx">pSQL</span><span class="p">(</span><span class="nx">_DB_PREFIX_</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;democqrshooksusage_reviewer`&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dcur&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dcur.`id_customer` = c.`id_customer`&#39;</span>
        <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;is_allowed_for_review&#39;</span> <span class="o">===</span> <span class="nv">$searchCriteria</span><span class="o">-&gt;</span><span class="na">getOrderBy</span><span class="p">())</span> <span class="p">{</span>
            <span class="nv">$searchQueryBuilder</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;dcur.`is_allowed_for_review`&#39;</span><span class="p">,</span> <span class="nv">$searchCriteria</span><span class="o">-&gt;</span><span class="na">getOrderWay</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$searchCriteria</span><span class="o">-&gt;</span><span class="na">getFilters</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$filterName</span> <span class="o">=&gt;</span> <span class="nv">$filterValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;is_allowed_for_review&#39;</span> <span class="o">===</span> <span class="nv">$filterName</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$searchQueryBuilder</span><span class="o">-&gt;</span><span class="na">andWhere</span><span class="p">(</span><span class="s1">&#39;dcur.`is_allowed_for_review` = :is_allowed_for_review&#39;</span><span class="p">);</span>
                <span class="nv">$searchQueryBuilder</span><span class="o">-&gt;</span><span class="na">setParameter</span><span class="p">(</span><span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">,</span> <span class="nv">$filterValue</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$filterValue</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$searchQueryBuilder</span><span class="o">-&gt;</span><span class="na">orWhere</span><span class="p">(</span><span class="s1">&#39;dcur.`is_allowed_for_review` IS NULL&#39;</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>This sample demonstrates how to extend sql of the customers grid. From our custom database table <code>democqrshooksusage_reviewer</code> we fetch the result of field <code>is_allowed_for_review</code>. This name must match the id we added in the grid definition. In order for sorting to work we also add <code>orderBy</code> condition and finally, in order
for filters to work <code>where</code> conditions are added if the filter exists in <code>$searchCriteria-&gt;getFilters()</code>.</p>
<h3 id="result">Result</h3>
<p>After completing the steps above by going to customers list you should see new column &ldquo;allowed for review&rdquo; added.</p>
<figure>
    <img src="../img/extended_customers_grid.png"/> <figcaption>
            <h4>Allowed for review column added to customers list</h4>
        </figcaption>
</figure>

<h2 id="adding-new-form-field-to-customer-form">Adding new form field to customer form</h2>
<h3 id="modifying-customers-form-builder">Modifying customers form builder</h3>
<p>In this step we are appending to the customers form a new <code>SwitchType</code> form field - its one of many form types which already exist in PrestaShop. More information
about it can be found <a href="/1.7/development/components/form/types-reference/">here</a>.</p>

<div class="notices note" ><p><strong>This example has been simplified for practical reasons.</strong></p>
<p>You can find full implementation <a href="https://github.com/PrestaShop/demo-cqrs-hooks-usage-module">here</a> which uses CQRS pattern to get reviewer state. <a href="/1.7/development/architecture/domain/cqrs/">More about it here</a>.</p>
</div>

<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1">// modules/ps_democqrshooksusage/ps_democqrshooksusage.php
</span><span class="c1"></span>
<span class="k">use</span> <span class="nx">Symfony\Component\Form\FormBuilderInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">PrestaShopBundle\Form\Admin\Type\SwitchType</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Ps_DemoCQRSHooksUsage</span> <span class="k">extends</span> <span class="nx">Module</span>
<span class="p">{</span>
    
    <span class="c1">// ...
</span><span class="c1"></span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">hookActionCustomerFormBuilderModifier</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="sd">/** @var FormBuilderInterface $formBuilder */</span>
        <span class="nv">$formBuilder</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;form_builder&#39;</span><span class="p">];</span>
        <span class="nv">$formBuilder</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">,</span> <span class="nx">SwitchType</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span>
            <span class="s1">&#39;label&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getTranslator</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">trans</span><span class="p">(</span><span class="s1">&#39;Allow reviews&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="s1">&#39;Modules.Ps_DemoCQRSHooksUsage&#39;</span><span class="p">),</span>
            <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
        <span class="p">]);</span>

        <span class="nv">$customerId</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>

        <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getIsAllowedForReview</span><span class="p">(</span><span class="nv">$customerId</span><span class="p">);</span>

        <span class="nv">$formBuilder</span><span class="o">-&gt;</span><span class="na">setData</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">function</span> <span class="nf">getIsAllowedForReview</span><span class="p">(</span><span class="nv">$customerId</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// implement your data retrieval logic here
</span><span class="c1"></span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>In this sample by using <a href="https://symfony.com/doc/current/forms.html">Symfony form builder</a> we just added another Form type. To determine if its
on or off we also need to reset its form data by assigning <code>is_allowed_for_review</code> value to <code>true</code> or <code>false</code>.</p>
<h3 id="result-1">Result</h3>
<p>By completing the steps above newly added switch is now visible in the customers form.</p>
<figure>
    <img src="../img/allow_for_review_switch.png"/> <figcaption>
            <h4>Allowed for review switch added to customers form</h4>
        </figcaption>
</figure>

<h2 id="extending-customers-form-after-create-and-update-actions">Extending customers form after create and update actions</h2>
<p>In the previous example we have added a switch field ! But when we want to save its state (on or off) nothing happens. The data is not modified. This is because we have not used the hooks
dedicated to handle this topic - lets do that!</p>

<div class="notices note" ><p><strong>This example has been simplified for practical reasons.</strong></p>
<p>You can find full implementation <a href="https://github.com/PrestaShop/demo-cqrs-hooks-usage-module">here</a> which uses CQRS pattern to create or update reviewer state. <a href="/1.7/development/architecture/domain/cqrs/">More about it here</a>.</p>
</div>

<div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">hookActionAfterUpdateCustomerFormHandler</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">updateCustomerReviewStatus</span><span class="p">(</span><span class="nv">$params</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">hookActionAfterCreateCustomerFormHandler</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">updateCustomerReviewStatus</span><span class="p">(</span><span class="nv">$params</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">function</span> <span class="nf">updateCustomerReviewStatus</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$customerId</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
    <span class="sd">/** @var array $customerFormData */</span>
    <span class="nv">$customerFormData</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;form_data&#39;</span><span class="p">];</span>
    <span class="nv">$isAllowedForReview</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bool</span><span class="p">)</span> <span class="nv">$customerFormData</span><span class="p">[</span><span class="s1">&#39;is_allowed_for_review&#39;</span><span class="p">];</span>
    
    <span class="c1">// implement review status saving here
</span><span class="c1"></span><span class="p">}</span>

</code></pre></div><p>when we created the switch type form we named it <code>is_allowed_for_review</code>. By using the same name we can get the state (on or off).
This hook receives from <code>$params</code> the form data, that you can retrieve like this: <code>$params['form_data']</code>.
All the form data is available here, including <code>is_allowed_for_review</code> data which comes from the switch.</p>
<p>You can find example module here:
<a href="https://github.com/PrestaShop/example-modules/tree/master/demoextendsymfonyform2">https://github.com/PrestaShop/example-modules/tree/master/demoextendsymfonyform2</a></p>


<footer class="article-footer">
	
<div>
  Last updated on July 27, 2021
  :
  <a href="https://github.com/PrestaShop/docs/commit/1e7493916e2760614a1d32cbe1893a9e9dbeebdb">"Fix wrong links" (1e7493916)</a>
  
</div>


	<div class="license">
		This article is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
	</div>
</footer>

        
        </div>
        

      </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1627507034"></script>
    <script src="/js/perfect-scrollbar.min.js?1627507034"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1627507034"></script>
    <script src="/js/jquery.sticky.js?1627507034"></script>
    <script src="/js/featherlight.min.js?1627507034"></script>
    <script src="/js/html5shiv-printshiv.min.js?1627507034"></script>
    <script src="/js/modernizr.custom-3.6.0.js?1627507034"></script>
    <script src="/js/learn.js?1627507034"></script>
    <script src="/js/hugo-learn.js?1627507034"></script>
    
    <script src="/main.js?1627507034"></script>
    <link href="/mermaid/mermaid.css?1627507034" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1627507034"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-2753771-44', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: 'e5a3a32dad46a5aaaa771b2b37d7084a',
indexName: 'prestashop',
inputSelector: '#search-by',
debug: false
});
</script>

  </body>
</html>

